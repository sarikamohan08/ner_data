import os
import zipfile

def extract_and_rename_zip(folder_path):
    # Loop through all files in folder
    for file in os.listdir(folder_path):
        if file.endswith(".zip"):
            zip_path = os.path.join(folder_path, file)
            zip_name = os.path.splitext(file)[0]  # Get zip filename without extension

            with zipfile.ZipFile(zip_path, 'r') as zip_ref:
                for member in zip_ref.namelist():
                    # Extract file
                    extracted_path = zip_ref.extract(member, folder_path)

                    # Build new filename
                    base, ext = os.path.splitext(member)
                    new_name = f"{base}_{zip_name}{ext}"
                    new_path = os.path.join(folder_path, new_name)

                    # Rename extracted file
                    os.rename(extracted_path, new_path)

            # Delete the zip file after processing
            os.remove(zip_path)
            print(f"Processed and removed: {zip_path}")

# Example usage
extract_and_rename_zip("path/to/your/folder")
