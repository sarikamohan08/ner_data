import os
import camelot
import pandas as pd

# Path to the PDF file
pdf_path = 'path_to_your_pdf.pdf'
output_folder = 'path_to_save_excel_files'

# Ensure the output folder exists
if not os.path.exists(output_folder):
    os.makedirs(output_folder)

# Path to save the Excel file
excel_file_name = os.path.splitext(os.path.basename(pdf_path))[0] + '.xlsx'
excel_path = os.path.join(output_folder, excel_file_name)

# Extract tables from the PDF (use lattice for better structured tables)
tables = camelot.read_pdf(pdf_path, pages='all', flavor='lattice')  # Or use 'stream' for simpler tables

# Check if tables were extracted
if len(tables) == 0:
    print("No tables found in the PDF.")
else:
    # Create an Excel writer object
    with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
        # Loop over each table and write it to a separate sheet
        for i, table in enumerate(tables):
            # Convert the extracted table to a pandas DataFrame
            df = table.df
            
            # Name each sheet as 'Table_1', 'Table_2', etc.
            sheet_name = f'Table_{i+1}'
            
            # Write the DataFrame to a sheet in the Excel file
            df.to_excel(writer, sheet_name=sheet_name, index=False)
            
            print(f"Table {i+1} extracted and saved to sheet '{sheet_name}'")

    print(f"All tables have been extracted and saved to {excel_path}")
