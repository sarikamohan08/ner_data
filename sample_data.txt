import camelot
import pandas as pd

# Path to the PDF file
pdf_path = 'path_to_your_pdf.pdf'

# Extract tables from the PDF
tables = camelot.read_pdf(pdf_path, pages='all', flavor='lattice')  # Use 'stream' if needed

# Check if any tables were extracted
if len(tables) == 0:
    print("No tables found in the PDF.")
else:
    # Initialize an empty list to store the DataFrames
    df_list = []

    # Loop over each table, convert to DataFrame, and check if it's not empty
    for i, table in enumerate(tables):
        df = table.df
        if not df.empty:
            df_list.append(df)
        else:
            print(f"Table {i + 1} is empty and will be skipped.")

    # Check if there are any DataFrames to concatenate
    if len(df_list) == 0:
        print("No valid tables to concatenate.")
    else:
        # Concatenate all DataFrames into one DataFrame
        combined_df = pd.concat(df_list, ignore_index=True)

        # Path to save the Excel file
        excel_path = 'combined_tables.xlsx'

        # Write the combined DataFrame to a single sheet in the Excel file
        combined_df.to_excel(excel_path, sheet_name='All_Tables', index=False)

        print(f"All tables have been combined and saved to {excel_path}")
