import camelot
import pandas as pd

# Path to your PDF file
pdf_path = 'your_file.pdf'

# Extract tables from the PDF
tables = camelot.read_pdf(pdf_path, pages='all')

# Create a new Excel writer object
excel_path = 'extracted_tables.xlsx'
with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
    # Loop through each table
    for i, table in enumerate(tables):
        # Convert the table to a pandas DataFrame
        df = table.df
        
        # Save the DataFrame to a different sheet in the Excel file
        sheet_name = f'Table_{i+1}'
        df.to_excel(writer, sheet_name=sheet_name, index=False)

print(f"Tables extracted and saved to {excel_path}")
