import os
from excel_processor import ExcelProcessor  # Assuming the class is saved in `excel_processor.py`

def process_excel_files_in_folder(folder_path, output_folder):
    """
    Process all Excel files in the given folder and save outputs in the specified output folder.
    
    Args:
        folder_path (str): Path to the folder containing Excel files.
        output_folder (str): Path to the folder where processed files will be saved.
    """
    # Ensure the output folder exists
    os.makedirs(output_folder, exist_ok=True)
    
    # Iterate through all files in the folder
    for filename in os.listdir(folder_path):
        if filename.endswith(".xlsx") or filename.endswith(".xls"):  # Check for Excel files
            input_file_path = os.path.join(folder_path, filename)
            output_file_path = os.path.join(output_folder, f"processed_{filename}")
            
            print(f"Processing file: {filename}")
            
            # Process the file using the ExcelProcessor class
            try:
                processor = ExcelProcessor(input_file_path)
                processor.process_all_sheets()
                processor.save_to_excel(output_file_path)
                print(f"Processed and saved: {output_file_path}")
            except Exception as e:
                print(f"Error processing {filename}: {e}")

if __name__ == "__main__":
    folder_path = "path_to_folder"  # Replace with the folder containing Excel files
    output_folder = "path_to_output_folder"  # Replace with desired output folder path
    
    process_excel_files_in_folder(folder_path, output_folder)
