import os
import camelot
import pandas as pd

# Folder containing PDF files
pdf_folder = 'path_to_pdf_folder'
excel_folder = 'path_to_excel_folder'  # Folder where Excel files will be saved

# Create the output folder if it doesn't exist
if not os.path.exists(excel_folder):
    os.makedirs(excel_folder)

# Iterate over each file in the folder
for filename in os.listdir(pdf_folder):
    if filename.endswith('.pdf'):
        pdf_path = os.path.join(pdf_folder, filename)
        
        # Extract tables from the current PDF
        tables = camelot.read_pdf(pdf_path, pages='all')
        
        # Create an Excel file with the name of the PDF
        excel_filename = os.path.splitext(filename)[0] + '.xlsx'
        excel_path = os.path.join(excel_folder, excel_filename)
        
        # Create a Pandas Excel writer for the current PDF
        with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
            for i, table in enumerate(tables):
                # Convert each table to a DataFrame
                df = table.df
                
                # Save each DataFrame to a separate sheet
                sheet_name = f'Table_{i+1}'
                df.to_excel(writer, sheet_name=sheet_name, index=False)
        
        print(f'Extracted tables from {filename} and saved to {excel_filename}')

print("All PDFs have been processed.")
