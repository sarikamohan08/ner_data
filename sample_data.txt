clean_chunks = [chunk for chunk in chunks if isinstance(chunk, str) and chunk.strip()]
    if not clean_chunks:
        raise ValueError("All input chunks are empty or invalid.")
