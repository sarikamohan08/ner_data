if pd.isna(row['service_description']):
            continue
            
        service_desc = str(row['service_description'])
        
        # Try multiple patterns to extract revenue codes
        patterns = [
            r'revenue code\s+([0-9,\s]+)(?=[.,]|$)',  # Ends with period or comma
            r'revenue code\s+([0-9,\s]+)',            # Just get all numbers after "revenue code"
            r'(?:associated with|with)\s+revenue code\s+([0-9,\s]+)(?=[.,]|$)'  # With "associated with" prefix
        ]
        
        for pattern in patterns:
            match = re.search(pattern, service_desc, re.IGNORECASE)
            if match:
                codes = match.group(1).strip()
                # Store the extracted codes
                result_df.loc[idx, 'rev_code'] = codes
                break
