def extract_text_from_pdf(pdf_path, output_dir, pages):
    images = convert_from_path(pdf_path)
    extracted_text = ""
    
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    text_output_path = os.path.join(output_dir, "extracted_text.txt")
    
    for i, image in enumerate(images):
        if i + 1 in pages:  # Process only specified pages
            text = pytesseract.image_to_string(image)
            extracted_text += text + "\n\n"
    
    with open(text_output_path, "w", encoding="utf-8") as text_file:
        text_file.write(extracted_text)
    
    print(f"Extracted text saved to {text_output_path}")

def extract_tables_from_pdf(pdf_path, output_dir, pages):
    pages_str = ",".join(map(str, pages))  # Convert list of pages to string format for camelot
    tables = camelot.read_pdf(pdf_path, pages=pages_str)
    
    tables_output_dir = os.path.join(output_dir, "extracted_tables")
    if not os.path.exists(tables_output_dir):
        os.makedirs(tables_output_dir)
    
    for i, table in enumerate(tables):
        table_path = os.path.join(tables_output_dir, f"table_{i+1}.xlsx")
        df = table.df
        df.to_excel(table_path, index=False)
        print(f"Table {i+1} saved to {table_path}")
