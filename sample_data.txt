# Iterate over each row in the DataFrame
    for index, row in df.iterrows():
        description = row['service_description']
        if isinstance(description, str):  # Ensure the input is a string
            match = re.search(r'revenue code (\d+(?:,\d+)*)', description)
            if match:
                # Update the 'code' column with the extracted revenue codes
                df.at[index, 'code'] = match.group(1)
                # Update the 'rev_code' column to 1 if 'code' is populated
                df.at[index, 'rev_code'] = 1
    return df
