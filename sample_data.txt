# Step 1: Build the dict from 'payment basis' entries
rate_dict = {
    row['provider_name']: row['rate']
    for row in df
    if row['service'] == 'payment basis'
}

# Step 2: Update 'rate' for 'catastrophic threshold' using the dict
for row in df:
    if row['service'] == 'catastrophic threshold':
        provider = row['provider_name']
        if provider in rate_dict:
            row['rate'] = rate_dict[provider]
