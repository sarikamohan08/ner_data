import os
import zipfile

input_dir = '/path/to/zips'
output_dir = '/path/to/output_dir'

for zip_name in os.listdir(input_dir):
    if zip_name.endswith('.zip'):
        zip_base = os.path.splitext(zip_name)
        zip_path = os.path.join(input_dir, zip_name)
        with zipfile.ZipFile(zip_path, 'r') as z:
            for member in z.namelist():
                if not member.endswith('/'):
                    file_base, ext = os.path.splitext(os.path.basename(member))
                    new_name = f"{file_base}_{zip_base}{ext}"
                    output_path = os.path.join(output_dir, new_name)
                    with open(output_path, 'wb') as out_file:
                        out_file.write(z.read(member))
        os.remove(zip_path)  # Delete ZIP file after extraction
