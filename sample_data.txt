code_str = response['choices'][0]['message']['content']

# Execute the returned code safely to get the DataFrame in 'df'
local_vars = {}
exec(code_str, {'pd': pd}, local_vars)
df = local_vars.get('df')
