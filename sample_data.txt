prompt = (
    "Extract healthcare services data from insurance contracts. Follow these steps:\n\n"
    
    "STEP 1: EXTRACT BASIC PROVIDER INFORMATION (first occurrence only):\n"
    "- PROVIDER_NAME: Name of the provider\n"
    "- EFFECTIVE_FROM_DATE: Effective date of coverage\n" 
    "- NPI: Provider's NPI number\n"
    "- TAX_ID: Provider's tax identification number\n\n"
    
    "STEP 2: IDENTIFY AND EXTRACT SERVICES:\n"
    "Look for these service patterns in narratives, tables, and paragraphs:\n"
    "A. Covered Services phrases: 'Covered Services rendered', 'Covered Services not listed', 'Covered Services provided'\n"
    "B. Skilled Nursing Facility Levels: 'Level 1', 'Level 2', 'Level 3', 'Level 4', 'SNF Level services'\n"
    "C. Specific services: 'Drugs & Biologicals', 'All other services', 'Long term care days', 'Home leave days', 'Hospital leave days'\n"
    "D. Table services under headings: 'Medicaid or Medicare Dual Eligible', 'Skilled Nursing Facility Services Reimbursement'\n\n"
    
    "STEP 3: FOR EACH SERVICE FOUND, EXTRACT THESE FIELDS:\n"
    "- SERVICE_TYPE: 'inpatient', 'outpatient', 'inpatient services', 'outpatient services'\n"
    "- SERVICES: Specific service name/level (e.g., 'Level 1', 'Covered Services rendered')\n"
    "- SERVICE_DESC: Description below each service level\n"
    "- REIMBURSEMENT_AMT: Dollar amount if available (e.g., '$65.00')\n"
    "- REIMBURSEMENT_RATE: Percentage rate if available (e.g., '65%')\n"
    "- REIMBURSEMENT_METHODOLOGY: 'Per Diem', 'Fee Schedule', 'Medicaid Allowable', 'Percent of Charge'\n"
    "- CODES: Revenue codes, fee schedule codes (e.g., '005-335', '101', '191')\n"
    "- METHOD_OF_PAYMENT: MOP codes ('no1', 'no2', 'po3', etc.)\n\n"
    
    "STEP 4: EXTRACT CODE INDICATORS (1 if present, 0 otherwise):\n"
    "- REVENUE_CD_IND: Revenue codes present\n"
    "- DRG_CD_IND: MS-DRG codes present\n"
    "- CPT_IND: CPT codes present\n"
    "- HCPCS_IND: HCPCS codes present\n"
    "- ICD_CD_IND: ICD codes present\n"
    "- DIAGNOSIS_CD_IND: Diagnosis codes present\n"
    "- MODIFIER_CD_IND: Modifier codes present\n\n"
    
    "STEP 5: EXTRACT ADDITIONAL FIELDS:\n"
    "- LOB_IND: 'Medicare', 'Medicaid', 'Commercial' (comma-separated if multiple)\n"
    "- AGE_GROUP: 1 if 'Age group' mentioned, else 0\n"
    "- GROUPER_IND: 1 if 'grouper' mentioned, else 0\n"
    "- GROUPER: Grouper column values if present\n"
    "- APC_IND: 1 if 'APC' mentioned, else 0\n"
    "- MSR_IND: 1 if 'Multiple Surgery Logic' mentioned, else 0\n"
    "- BILATERAL_PROCEDURE_IND: 1 if 'bilateral procedures' mentioned, else 0\n"
    "- PROVIDER_SPECIALTY: 1 if 'provider specialty' mentioned, else 0\n"
    "- EXCLUDE_FROM_TRANSFER_IND: 1 if 'transfers' mentioned, else 0\n"
    "- TRANSFER_CALCULATION: Transfer calculation text if present\n"
    "- EXCLUDE_FROM_STOPLOSS_IND: 1 if 'stop loss threshold' mentioned, else 0\n"
    "- OTHER_FLAT_FEE: 1 if 'flat fee' mentioned, else 0\n"
    "- SURG_FLAT_FEE: 1 if 'flat surge fee' or 'surgical fee' mentioned, else 0\n"
    "- CASE_RATE: Case rate text with duration in days\n"
    "- HEALTH_BENEFIT_PLANS: Health benefit plan from tables\n\n"
    
    "EXAMPLES OF SERVICE EXTRACTION:\n"
    "Example 1: 'Provider agrees to accept 65% of Humana's (005-335) fee schedule for Covered Services rendered'\n"
    "→ SERVICE_TYPE: 'outpatient', SERVICES: 'Covered Services rendered', REIMBURSEMENT_RATE: '65%', CODES: '005-335', REIMBURSEMENT_METHODOLOGY: 'Fee Schedule'\n\n"
    
    "Example 2: Table with '101 | Long-Term Care Days | 100% Medicaid Allowable'\n"
    "→ SERVICES: 'Long term care days', CODES: '101', REIMBURSEMENT_RATE: '100%', REIMBURSEMENT_METHODOLOGY: 'Medicaid Allowable'\n\n"
    
    "OUTPUT FORMAT:\n"
    "Create a list of dictionaries where each dictionary represents one service record with all the above fields.\n"
    "Output only valid Python code assigning to variable 'combined_data'.\n"
)
