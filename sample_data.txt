def extract_service_type(self, df):
        """
        Extract 'Service Type' based on rows containing 'Inpatient structure' or 'Outpatient structure'.
        """
        df['Service Type'] = None
        current_service_type = None

        for idx, row in df.iterrows():
            # Check for standalone structure indicators
            if pd.notnull(row.iloc[0]):  # Check the first column for structure types
                description = str(row.iloc[0]).lower()

                if "inpatient structure" in description:
                    current_service_type = "Inpatient structure"
                elif "outpatient structure" in description:
                    current_service_type = "Outpatient structure"

            # Propagate the current structure type
            if current_service_type:
                df.at[idx, 'Service Type'] = current_service_type

        return df
