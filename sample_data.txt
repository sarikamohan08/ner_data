for idx, row in result_df[result_df['code'].isnull()].iterrows():
        service_desc = row['service_description']
        
        # Check if service description contains revenue code pattern
        if 'revenue code' in service_desc.lower():
            # Extract the revenue codes until comma or full stop
            pattern = r'revenue code\s+([0-9,\s]+)(?:[.,]|$)'
            match = re.search(pattern, service_desc, re.IGNORECASE)
            
            if match:
                # Get the extracted codes and clean them up
                codes = match.group(1).strip()
                # Set indicator 1 in rev_code column
                result_df.at[idx, 'rev_code'] = '1'
    
    return result_df
