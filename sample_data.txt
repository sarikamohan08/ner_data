import os
import fitz  # PyMuPDF for extracting text from PDFs
import pandas as pd

def extract_text_from_pdf(pdf_path):
    """
    Extract text from a single PDF file.
    :param pdf_path: Path to the PDF file.
    :return: Extracted text as a string.
    """
    text = ""
    try:
        with fitz.open(pdf_path) as pdf:
            for page_num in range(len(pdf)):
                page = pdf[page_num]
                text += page.get_text()
    except Exception as e:
        print(f"Error reading {pdf_path}: {e}")
    return text

def process_pdfs_in_folder(folder_path, output_excel):
    """
    Process all PDF files in a folder and save their content into an Excel file.
    :param folder_path: Path to the folder containing PDF files.
    :param output_excel: Path to save the output Excel file.
    """
    # List all PDF files in the folder
    pdf_files = [f for f in os.listdir(folder_path) if f.lower().endswith('.pdf')]
    data = []

    for pdf_file in pdf_files:
        pdf_path = os.path.join(folder_path, pdf_file)
        print(f"Processing: {pdf_file}")
        text = extract_text_from_pdf(pdf_path)
        data.append({"File Name": pdf_file, "Content": text})

    # Save the extracted data to an Excel file
    df = pd.DataFrame(data)
    df.to_excel(output_excel, index=False, engine='openpyxl')
    print(f"Data saved to {output_excel}")

if __name__ == "__main__":
    folder_path = input("Enter the folder path containing PDF files: ")
    output_excel = input("Enter the output Excel file path (e.g., output.xlsx): ")
    process_pdfs_in_folder(folder_path, output_excel)
