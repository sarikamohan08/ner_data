import os
import shutil
import pandas as pd

# ==== CONFIGURE THESE PATHS ====
excel_file = r"C:\path\to\filenames.xlsx"   # Excel with filename column
root_folder = r"C:\path\to\root_folder"     # Folder to search PDFs
destination_folder = r"C:\path\to\destination"  # Where to copy matched PDFs
column_name = "filename"  # Column in Excel containing file names (without extension)

# Create destination folder if not exists
os.makedirs(destination_folder, exist_ok=True)

# Read Excel data
df = pd.read_excel(excel_file)

filenames = df[column_name].astype(str).tolist()

# Search all PDFs in root folder recursively
for root, dirs, files in os.walk(root_folder):
    for file in files:
        if file.lower().endswith(".pdf"):
            file_without_ext = os.path.splitext(file)[0]
            
            if file_without_ext in filenames:
                source_path = os.path.join(root, file)
                dest_path = os.path.join(destination_folder, file)
                
                shutil.copy2(source_path, dest_path)
                print(f"Copied: {file}")

print("Task Completed!")
