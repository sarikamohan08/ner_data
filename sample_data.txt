def extract_tables_as_text(pdf_path):
    extracted_texts = []
    with pdfplumber.open(pdf_path) as pdf:
        for page_num, page in enumerate(pdf.pages):
            tables = page.extract_tables()
            for table_index, table in enumerate(tables):
                if not table or not table[0]:
                    continue
                header = table[0]
                for row in table[1:]:
                    if len(row) != len(header):
                        continue  # skip malformed rows
                    row_dict = { 
                        (header[i] or "").strip(): (row[i] or "").strip() 
                        for i in range(len(header))
                    }
                    formatted = ", ".join(f"{k}: {v}" for k, v in row_dict.items() if v)
                    extracted_texts.append(f"Page {page_num + 1}, Table {table_index + 1}: {formatted}")
    return extracted_texts
