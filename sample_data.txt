def assign_ind(extracted):
    # extracted is expected to be a dictionary with all the keys
    for key, value in extracted.items():
        if isinstance(value, dict) or isinstance(value, list):
            # Handles both dictionaries and lists of dictionaries
            texts = []
            if isinstance(value, list):
                texts = [v.get('extracted text from pdf', '') for v in value]
            else:
                texts = [value.get('extracted text from pdf', '')]
            ind_val = 1 if any(texts) else 0
        else:
            ind_val = 0
        # Assign back the indicator
        if isinstance(value, list):
            for v in value:
                v[f"{key}_ind"] = ind_val
        elif isinstance(value, dict):
            value[f"{key}_ind"] = ind_val
        # If not dict or list, ignore
    return extracted
