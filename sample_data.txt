df['code'] = df.apply(
    lambda row: re.search(r'revenue code ([\d,]+)\.', row['service_description']).group(1)
    if pd.isnull(row['code']) and re.search(r'revenue code ([\d,]+)\.', row['service_description']) 
    else row['code'],
    axis=1
)

# Create the 'indicator' column based on whether 'code' was updated
df['indicator'] = df['code'].apply(lambda x: 1 if re.match(r'^\d+(,\d+)*$', str(x)) else 0)
