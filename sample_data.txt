if not isinstance(df, pd.DataFrame) or df.empty:
            print("Invalid DataFrame: DataFrame is empty or not loaded correctly.")
            return pd.Series()

        # Initialize variables
        current_service_type = None
        service_type_column = []

        # Iterate over rows to detect and propagate service type
        for idx, row in df.iterrows():
            # Check the first column for structure type keywords
            first_column = str(row.iloc[0]) if pd.notnull(row.iloc[0]) else ""
            first_column_cleaned = first_column.strip().lower()

            # Update current service type if a structure keyword is found
            if "inpatient structure" in first_column_cleaned:
                current_service_type = "Inpatient structure"
            elif "outpatient structure" in first_column_cleaned:
                current_service_type = "Outpatient structure"

            # Append the current service type to the new column
            service_type_column.append(current_service_type)

        return pd.Series(service_type_column)
