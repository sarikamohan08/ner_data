import openpyxl

def rename_excel_sheets(file_path):
    try:
        # Load the workbook with proper file handling
        with open(file_path, 'rb') as f:
            workbook = openpyxl.load_workbook(f)
        
        name_mapping = {
            'bot output-reply': 'ocr output-reply',
            'bot output-rts': 'ocr output-rts',
            'bot output-reply kickouts': 'ocr output-reply kickouts',
            'bot output-rts kickouts': 'ocr output-rts kickouts'
        }
        
        for sheet in workbook.sheetnames:
            if sheet in name_mapping:
                workbook[sheet].title = name_mapping[sheet]
        
        # Save to a temporary file first
        temp_path = file_path.replace('.xlsx', '_temp.xlsx')
        workbook.save(temp_path)
        
        # Close the workbook properly
        workbook.close()
        
        # Replace original file
        import os
        os.replace(temp_path, file_path)
        
        print(f"Sheet names updated in {file_path}")
    
    except PermissionError:
        print(f"Error: Could not access {file_path}. Please close the file in Excel or other programs.")
    except Exception as e:
        print(f"An error occurred: {str(e)}")

# Usage
file_path = 'your_file.xlsx'
rename_excel_sheets(file_path)
