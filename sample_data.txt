prompt = (
    "Extract healthcare services data from insurance contracts. Follow these steps:\n\n"
    
    "STEP 1: EXTRACT BASIC PROVIDER INFORMATION (first occurrence only):\n"
    "- PROVIDER_NAME: Name of the provider/facility\n"
    "- EFFECTIVE_FROM_DATE: Effective date of coverage (format: YYYY-MM-DD)\n" 
    "- NPI: Provider's NPI number (10-digit format)\n"
    "- TAX_ID: Provider's tax identification number (EIN)\n\n"
    
    "STEP 2: IDENTIFY AND EXTRACT SERVICES:\n"
    "Look for these service patterns in narratives, tables, and paragraphs:\n"
    "A. Covered Services phrases: 'Covered Services rendered', 'Covered Services not listed', 'Covered Services provided', 'Covered Services'\n"
    "B. Skilled Nursing Facility Levels: 'Level 1', 'Level 2', 'Level 3', 'Level 4', 'SNF Level services', 'Skilled Nursing'\n"
    "C. Specific services: 'Drugs & Biologicals', 'All other services', 'Long term care days', 'Home leave days', 'Hospital leave days', 'Pharmacy', 'Laboratory'\n"
    "D. Table services under headings: 'Medicaid or Medicare Dual Eligible', 'Skilled Nursing Facility Services Reimbursement', 'Reimbursement', 'Services'\n"
    "E. Service categories: 'inpatient', 'outpatient', 'professional', 'ancillary'\n\n"
    
    "STEP 3: FOR EACH SERVICE FOUND, EXTRACT THESE FIELDS:\n"
    "- SERVICE_TYPE: Categorize as 'inpatient', 'outpatient', 'inpatient services', 'outpatient services', 'professional', 'ancillary'\n"
    "- SERVICES: Specific service name/level (e.g., 'Level 1', 'Covered Services rendered', 'Skilled Nursing')\n"
    "- SERVICE_DESC: Detailed description of the service\n"
    "- REIMBURSEMENT_AMT: Dollar amount if available (extract numbers with currency symbols, e.g., '$65.00', '100.50')\n"
    "- REIMBURSEMENT_RATE: Percentage rate if available (extract percentages, e.g., '65%', '100 percent')\n"
    "- REIMBURSEMENT_METHODOLOGY: 'Per Diem', 'Fee Schedule', 'Medicaid Allowable', 'Percent of Charge', 'Capitation', 'Bundled Payment'\n"
    "- CODES: Revenue codes, fee schedule codes, procedure codes (e.g., '005-335', '101', '191', CPT/HCPCS codes)\n"
    "- METHOD_OF_PAYMENT: Payment codes or methods ('no1', 'no2', 'po3', 'Fee-for-Service', 'Value-Based')\n\n"
    
    "STEP 4: EXTRACT CODE INDICATORS (1 if present, 0 otherwise):\n"
    "- REVENUE_CD_IND: Revenue codes present (format: XXX-XXX)\n"
    "- DRG_CD_IND: MS-DRG codes present\n"
    "- CPT_IND: CPT codes present (typically 5-digit)\n"
    "- HCPCS_IND: HCPCS codes present (alphanumeric, 5 characters)\n"
    "- ICD_CD_IND: ICD-9/ICD-10 codes present\n"
    "- DIAGNOSIS_CD_IND: Diagnosis codes present\n"
    "- MODIFIER_CD_IND: Modifier codes present (e.g., -25, -59)\n\n"
    
    "STEP 5: EXTRACT ADDITIONAL FIELDS (USE 0 IF NOT MENTIONED):\n"
    "- LOB_IND: 'Medicare', 'Medicaid', 'Commercial', 'Dual Eligible' (comma-separated if multiple)\n"
    "- AGE_GROUP: 1 if 'Age group', 'pediatric', 'geriatric', or age ranges mentioned, else 0\n"
    "- GROUPER_IND: 1 if 'grouper', 'DRG grouper', or 'APR-DRG' mentioned, else 0\n"
    "- GROUPER: Grouper column values if present\n"
    "- APC_IND: 1 if 'APC', 'Ambulatory Payment Classification' mentioned, else 0\n"
    "- MSR_IND: 1 if 'Multiple Surgery Logic', 'Multiple Surgery Reduction' mentioned, else 0\n"
    "- BILATERAL_PROCEDURE_IND: 1 if 'bilateral procedures', 'bilateral surgery' mentioned, else 0\n"
    "- PROVIDER_SPECIALTY: 1 if 'provider specialty', 'specialist', or specific specialties mentioned, else 0\n"
    "- EXCLUDE_FROM_TRANSFER_IND: 1 if 'transfers', 'transfer cases', 'transfer payment' mentioned, else 0\n"
    "- TRANSFER_CALCULATION: Transfer calculation text if present\n"
    "- EXCLUDE_FROM_STOPLOSS_IND: 1 if 'stop loss threshold', 'stop-loss', 'catastrophic coverage' mentioned, else 0\n"
    "- OTHER_FLAT_FEE: 1 if 'flat fee', 'fixed fee', 'global fee' mentioned, else 0\n"
    "- SURG_FLAT_FEE: 1 if 'flat surge fee', 'surgical fee', 'surgery package' mentioned, else 0\n"
    "- CASE_RATE: Case rate text with duration in days\n"
    "- HEALTH_BENEFIT_PLANS: Health benefit plan names from tables\n\n"
    
    "CRITICAL OUTPUT REQUIREMENTS:\n"
    "1. EVERY service record MUST include ALL of these fields exactly as listed\n"
    "2. For indicator fields (BILATERAL_PROCEDURE_IND, PROVIDER_SPECIALTY, etc.), use 0 if not mentioned\n"
    "3. For text fields, use None if not available\n"
    "4. Do not skip any fields - include them all in every dictionary\n\n"
    
    "COMPLETE FIELD LIST (MUST INCLUDE ALL IN EVERY RECORD):\n"
    "['SERVICE_TYPE', 'SERVICES', 'SERVICE_DESC', 'REIMBURSEMENT_AMT', 'REIMBURSEMENT_RATE', 'REIMBURSEMENT_METHODOLOGY', 'CODES', 'METHOD_OF_PAYMENT', \n"
    "'REVENUE_CD_IND', 'DRG_CD_IND', 'CPT_IND', 'HCPCS_IND', 'ICD_CD_IND', 'DIAGNOSIS_CD_IND', 'MODIFIER_CD_IND',\n"
    "'LOB_IND', 'AGE_GROUP', 'GROUPER_IND', 'GROUPER', 'APC_IND', 'MSR_IND', 'BILATERAL_PROCEDURE_IND', 'PROVIDER_SPECIALTY', \n"
    "'EXCLUDE_FROM_TRANSFER_IND', 'TRANSFER_CALCULATION', 'EXCLUDE_FROM_STOPLOSS_IND', 'OTHER_FLAT_FEE', 'SURG_FLAT_FEE', 'CASE_RATE', 'HEALTH_BENEFIT_PLANS']\n\n"
    
    "EXAMPLES OF COMPLETE RECORDS:\n"
    "Example 1:\n"
    "{'SERVICE_TYPE': 'outpatient', 'SERVICES': 'Covered Services rendered', 'SERVICE_DESC': None, 'REIMBURSEMENT_AMT': None, 'REIMBURSEMENT_RATE': '65%', \n    'REIMBURSEMENT_METHODOLOGY': 'Fee Schedule', 'CODES': '005-335', 'METHOD_OF_PAYMENT': None, 'REVENUE_CD_IND': 1, 'DRG_CD_IND': 0, 'CPT_IND': 0, \n    'HCPCS_IND': 0, 'ICD_CD_IND': 0, 'DIAGNOSIS_CD_IND': 0, 'MODIFIER_CD_IND': 0, 'LOB_IND': 'Commercial', 'AGE_GROUP': 0, 'GROUPER_IND': 0, \n    'GROUPER': None, 'APC_IND': 0, 'MSR_IND': 0, 'BILATERAL_PROCEDURE_IND': 0, 'PROVIDER_SPECIALTY': 0, 'EXCLUDE_FROM_TRANSFER_IND': 0, \n    'TRANSFER_CALCULATION': None, 'EXCLUDE_FROM_STOPLOSS_IND': 0, 'OTHER_FLAT_FEE': 0, 'SURG_FLAT_FEE': 0, 'CASE_RATE': None, 'HEALTH_BENEFIT_PLANS': None}\n\n"
    
    "Example 2:\n"
    "{'SERVICE_TYPE': 'inpatient', 'SERVICES': 'Long term care days', 'SERVICE_DESC': None, 'REIMBURSEMENT_AMT': None, 'REIMBURSEMENT_RATE': '100%', \n    'REIMBURSEMENT_METHODOLOGY': 'Medicaid Allowable', 'CODES': '101', 'METHOD_OF_PAYMENT': None, 'REVENUE_CD_IND': 1, 'DRG_CD_IND': 0, 'CPT_IND': 0, \n    'HCPCS_IND': 0, 'ICD_CD_IND': 0, 'DIAGNOSIS_CD_IND': 0, 'MODIFIER_CD_IND': 0, 'LOB_IND': 'Medicaid', 'AGE_GROUP': 0, 'GROUPER_IND': 0, \n    'GROUPER': None, 'APC_IND': 0, 'MSR_IND': 0, 'BILATERAL_PROCEDURE_IND': 0, 'PROVIDER_SPECIALTY': 0, 'EXCLUDE_FROM_TRANSFER_IND': 0, \n    'TRANSFER_CALCULATION': None, 'EXCLUDE_FROM_STOPLOSS_IND': 0, 'OTHER_FLAT_FEE': 0, 'SURG_FLAT_FEE': 0, 'CASE_RATE': None, 'HEALTH_BENEFIT_PLANS': None}\n\n"
    
    "OUTPUT FORMAT:\n"
    "Create a list of dictionaries where each dictionary represents one service record with ALL fields listed above.\n"
    "Include ALL fields in EVERY record - do not skip any fields.\n"
    "Output only valid Python code assigning to variable 'combined_data'.\n"
    "Use None for missing text values and 0 for missing indicator values.\n"
)
