import pandas as pd
from llama_index import (
    Document,
    VectorStoreIndex,  # Use this or another relevant class based on your LlamaIndex version
)

# Load the Excel file
file_path = 'output.xlsx'
data = pd.read_excel(file_path, sheet_name=None)  # Load all sheets

# Process the first sheet
sheet_data = data[list(data.keys())[0]]  # Get the first sheet's DataFrame

# Convert DataFrame to a list of Document objects
documents = [Document(text=str(row)) for row in sheet_data.values]

# Create an index from the documents
index = VectorStoreIndex(documents)  # Adjust class name based on your version

# Perform a query
response = index.query("What information are you looking for?")  # Customize your query
print(response)
